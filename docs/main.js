(()=>{var x=class{constructor(t,e,i,o,f,S){this.name=t,this.speed=50,this.positionX=200,this.positionY=o,this.targetY=o,this.movementTimer=0,this.context=i,this.color=e,this.upKeyCode=f,this.downKeyCode=S,this.trail=[{x:0,y:o}]}static createPlayers(t){return[new x("right player","orange",t,190,"ArrowUp","ArrowDown"),new x("left player","green",t,210,"KeyW","KeyS")]}maxedOutMovement(){return this.movementTimer>0}moveUp(){this.maxedOutMovement()||(this.movementTimer=.25,this.targetY=this.targetY-10)}moveDown(){this.maxedOutMovement()||(this.movementTimer=.25,this.targetY=this.targetY+10)}update(t){this.trail.push({x:this.positionX,y:this.positionY}),this.positionX=this.positionX+this.speed*t;let e;Math.abs(this.targetY-this.positionY)>0?(e=(this.speed-30)*(Math.cos(this.movementTimer/.25*Math.PI)+1),this.targetY-this.positionY>0?this.positionY=Math.min(this.targetY,this.positionY+e*t):this.positionY=Math.max(this.targetY,this.positionY-e*t)):e=this.speed,this.positionX=this.positionX+e*t,this.movementTimer>0&&(this.movementTimer=this.movementTimer-t)}draw(t,e){this.context.resetTransform(),this.drawTrail(t,e)}drawTrail(t,e){this.cutTrail(t);let i=this.context;i.beginPath(),i.lineWidth=2*e.yScale,i.moveTo((this.trail[0].x-t)*e.xScale,this.trail[0].y*e.yScale);for(let o of this.trail)i.lineTo((o.x-t)*e.xScale,o.y*e.yScale);i.strokeStyle=this.color,i.stroke()}cutTrail(t){this.trail=this.trail.filter(e=>e.x>=t-200)}};var p=class{constructor(t){this.startLine=2400;this.end=4300;this.squares=[{x:0,y:0,size:50},{x:0,y:400,size:50},{x:200,y:400,size:50},{x:200,y:0,size:50},{x:400,y:400,size:50},{x:400,y:0,size:50},{x:600,y:400,size:50},{x:600,y:0,size:50},{x:800,y:400,size:50},{x:800,y:0,size:50},{x:1e3,y:400,size:50},{x:1e3,y:0,size:50},{x:1200,y:400,size:50},{x:1200,y:0,size:50},{x:1400,y:400,size:50},{x:1400,y:0,size:50},{x:1600,y:400,size:50},{x:1600,y:0,size:50},{x:1620,y:200,size:50},{x:1800,y:400,size:50},{x:1800,y:0,size:50},{x:2e3,y:400,size:50},{x:2e3,y:0,size:50},{x:2200,y:0,size:50},{x:2200,y:400,size:50},{x:2400,y:0,size:100},{x:2400,y:400,size:100},{x:2600,y:200,size:50},{x:2600,y:0,size:100},{x:2600,y:400,size:100},{x:2750,y:320,size:80},{x:2750,y:200,size:80},{x:2750,y:80,size:80},{x:2900,y:400,size:100},{x:2900,y:200,size:100},{x:2900,y:0,size:100},{x:3300,y:0,size:350},{x:3300,y:400,size:350},{x:3800,y:200,size:150},{x:3800,y:0,size:150},{x:3800,y:400,size:150}];this.context=t}collide(t,e){for(let i of this.squares){let o=i.x-i.size/2;if(t>=o&&t<=o+i.size){let f=i.y-i.size/2;if(e>=f&&e<=f+i.size)return!0}}return!1}finish(t){return t>=this.end}draw(t,e){let i=this.context;i.lineWidth=2*e.yScale;for(let o of this.squares){let f=o.x-o.size/2-t,S=o.y-o.size/2;i.strokeStyle="white",i.strokeRect(f*e.xScale,S*e.yScale,o.size*e.xScale,o.size*e.yScale)}t<2500&&(i.font=`${30*e.yScale}px sans-serif`,i.textAlign="left",i.fillStyle="green",i.fillText("Left is green",(400-t)*e.xScale,300*e.yScale),i.fillText("Use 'w' and 's' to move",(800-t)*e.xScale,300*e.yScale),i.fillStyle="orange",i.fillText("Right is orange",(400-t)*e.xScale,130*e.yScale),i.fillText("Use 'up' and 'down' to move",(800-t)*e.xScale,130*e.yScale),i.fillStyle="grey",i.fillText("avoid the squares =>",(1300-t)*e.xScale,210*e.yScale),i.fillStyle="grey",i.fillText("get to finish first!",(1900-t)*e.xScale,210*e.yScale),i.beginPath(),i.moveTo((this.startLine-t)*e.xScale,50*e.yScale),i.lineTo((this.startLine-t)*e.xScale,350*e.yScale),i.strokeStyle="grey",i.stroke()),i.beginPath(),i.moveTo((4300-t)*e.xScale,0*e.yScale),i.lineTo((4300-t)*e.xScale,400*e.yScale),i.strokeStyle="grey",i.stroke()}};var c,s,y,g=!1,z,u,h=!1,v,m=!1,T,d=0,l,a;function n(){return{xScale:l/400,yScale:a/400}}function Y(){if(s.resetTransform(),h){s.fillStyle="red",s.fillRect(0,0,l,a),s.font=`${30*n().yScale}px sans-serif`,s.textAlign="center",s.fillStyle="black",s.fillText(`\u{1F648} ${v} lost`,200*n().xScale,200*n().yScale),s.font=`${20*n().yScale}px sans-serif`,s.fillText("press 'r' to restart",200*n().xScale,230*n().yScale);return}if(m){s.fillStyle="green",s.fillRect(0,0,l,a),s.font=`${30*n().yScale}px sans-serif`,s.textAlign="center",s.fillStyle="black",s.fillText(`\u{1F680} ${T} won`,200*n().xScale,200*n().yScale),s.font=`${20*n().yScale}px sans-serif`,s.fillText("press 'r' to restart",200*n().xScale,230*n().yScale);return}s.clearRect(0,0,l,a),s.fillStyle="black",s.fillRect(0,0,l,a);for(let r of y)r.draw(z,n());u.draw(z,n()),g&&(s.fillStyle="rgba(20,20,20,0.8)",s.fillRect(0,0,l,a),s.globalAlpha=2,s.font=`${30*n().yScale}px sans-serif`,s.textAlign="center",s.fillStyle="white",s.fillText("paused",200*n().xScale,200*n().yScale))}function D(r){if(g||h||m)return;for(let e of y)e.update(r);z=y.reduce((e,i)=>e+i.positionX,0)/y.length-200;for(let e of y)u.collide(e.positionX,e.positionY)&&(h=!0,v=e.name);for(let e of y)u.finish(e.positionX)&&(m=!0,T=e.name)}function C(r){let t=r-d;d=r,D(t/1e3),Y(),window.requestAnimationFrame(C)}function b(){let r=window.innerWidth,t=window.innerHeight;console.log(l,a),r>t?(l=t,a=t):(l=r,a=r),c.width=l,c.height=a}function k(r){r.code=="Space"&&!(h||m)&&(g=!g);for(let t of y)r.code==t.upKeyCode&&t.moveUp(),r.code==t.downKeyCode&&t.moveDown();if(r.code=="KeyR"&&(h||m)){y=x.createPlayers(s);for(let t of y)t.positionX=u.startLine;m=!1,h=!1}}function R(){c=document.getElementById("canvas"),l=c.width,a=c.height,z=200,s=c.getContext("2d"),window.addEventListener("keydown",k),window.addEventListener("resize",b),b(),y=x.createPlayers(s),u=new p(s),C(performance.now())}R();})();
//# sourceMappingURL=main.js.map
